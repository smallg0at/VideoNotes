<!DOCTYPE html>
<html lang="zh" style="background: black;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VideoNotes</title>
    <link rel="stylesheet" importance="high" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
    <link rel="shortcut icon" sizes="128 x 128" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAQcSURBVHhe7dsxL2xBGMbxcQsqHYVIJDqFUEkUFFqNROEDiFZJqVBSivgEGoVSq6CQqIhColCpiEZFc+8+kzObY+PYdc05M7Pz/yXsHm5xY97zzDszZw0AAAAAAAAAAAAAAACAPjKgb39b7BWyMtDyp3gPj1K6nz4lQKsg9IJfuLi4KN4Zs7i4WLyLiytQEgCGAsgcU4BnVVNA+echlP8vTAFoIwE865YACwsL9rUpl5eX9pUEwJcogMxRAJmjADJHE+gZy0AkhQTwrCoBYkICoI0CyBwFkDl6AM9YBSApJIBn3RIg+8OgpaUls7m5WVwhtCBTwNramjk7O7PFgLCC9QDDw8Nmd3fXHB4emunp6eKnaFqwAhgZGbGvMzMz5ujoiGkhkMabQMW+7nwVwNTUlLm/vzcvLy/Fb43Z2dkx5+fnxVV6WAb+kIpgdna2nQgqjpOTE6aFhgRPgDIlwePjo3l/f7fXSgIlQkqqEiAmUSVAmYpibm7OjI+P22sVi/6gWjWgHlEVgDM5OWkLwU0LahA1LbBs9C/KApChoSE7RehL78fGxuzUsb+/b0ZHR4t/hd+Kqgf4ztPTk+0PHCXCwcFBcRUPVgE1UV+gfXQ3LbCb6EcyCVCm1YIS4e3tzV7f3t7azaS7uzt7HVK3BOCTQR6oeLR34AqI3cT/l2QBOCqEzmlBdxrTQu+SLgBHSdC5m3h8fMxuYg/6ogBEp4sqBDctTExM2GlBxYBqSTaBvdCSUY2ioyWjlo51YxkYCXYTe9O3CVDWech0dXVl9vb2zPPzs732qSoBYpJFApSp2JQGSgWZn583p6enHDK1ZFEAqJZFAWgKuL6+bp8laApYXV1tpCmMXV/3AJrzNejukTNtHW9vb9e6ZcwqIBIaeN31bvD1ZNHy8nIU5wUx6bsEaLLj/0q3BOAwqCYa8JubG/uUsd6/vr7aeX5ra6uxwU9R8gWgwdagK+41x+tLcb+yssLA9yDpAlDc61kAN8/rKWLN8yl/rqBpSRaA7nLd8S7u3bIutUfIY5BUE6jB7lzW6SHRmO54loE10cleeVmn0z3i/veiT4DQy7qfqkqAmCSRAK67d/O86+5Z1vkVZQFU7eIR9/5FVQAacA28e5LHdfcMfH2i6AFc3CvmRbt4GxsbSUY9q4AfcAPPLl44QRNAA17u7tXgpa5bAnAYVNB8r8F/eHhoH9qgecEKwMX9+vo6cR9QkALQo1gs6+LQeAFo0GP8XH+uGm8C+x3LQCSFBPCsKgFiQgKgjQLIHAWQOXoAz1gFICkkgGfdEoDDIESFAsgcBZA5CiBzNIGesQxEUkgAz6oSICYkANoogMxRAJn71APAj4+PDzM4OFhcxUs9AAWQMTf+AAAAAAAAAAAAAAAAAAAAAAAASI4x/wDxTht4UVJ/sAAAAABJRU5ErkJggg==" type="image/x-icon">
    <!-- <link rel="shortcut icon" sizes="16 x 16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADvSURBVFhH7ZbNDcIwDIULc7AIgzAIa3HlzAbc2IQbp9bPxVGwZMuBIB+aT3pyQl3r9fETpsHm2ZHmdZnHPwxEZ86SAGpPZKZnpFyPum0hOnPevxdpeAaOpF/Twf2WmEgCD9JhXTaD99lSobhRSAKiMymKNVPDfVazNvAk3UiRNGRmfb8W4CobjTZQ60TyQE8E7rOaPQNI40qy0kBPBO6zmj0DtS4kDV6XaglwlY3GM/AipSaQ8hnAU99Jad+CtN+B6FPXdDXwDXIfqiXAVTY9ic7MP45xKsHtx+nUAZnpJVGuR+NqITqz/CccDLbKNC3BYZd+KkW/eAAAAABJRU5ErkJggg==" type="image/x-icon"> -->

    <style>
        html {
            touch-action: none;
        }

        body {
            background-color: black;
            display: flex;
            margin: 0;
            touch-action: none;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, '更纱黑体 SC', '微软雅黑', 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        * {
            scrollbar-width: thin;
            /* scrollbar-color: #808080 #1d1d1d; */
            scrollbar-color: dark;
            scrollbar-face-color: white;
            scrollbar-track-color: #222222;
            scrollbar-arrow-color: white;
            -ms-overflow-style: scrollbar;
            -ms-overflow-style: -ms-autohiding-scrollbar;

        }

        ::-webkit-scrollbar {
            background-color: #080808;
            width: 10px;
            height: 10px;

        }

        ::-webkit-scrollbar-track {
            padding: 10px 0;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #808080;
            border-radius: 10px;
            cursor: default;
        }

        ::-webkit-scrollbar-thumb:hover,
        ::-webkit-resizer:hover {
            background-color: #a0a0a0;
        }

        ::-webkit-scrollbar-thumb:active {
            background-color: #a0a0a0;
        }

        ::-webkit-scrollbar-corner {
            /* background-color: #797979; */
            background-color: transparent;
        }

        textarea::-webkit-resizer {
            color: transparent;
            border-radius: 10px 10px 0 0;
            /* background: none; */
            background-color: #808080;
            color: white;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACvSURBVFhH7ZSBCsQgDEPdfbl/vlukGZ7TomA7DvogbK3SRART8NfknE9ISl/EuMg9RG1OuYXomVPmITRzyixEa17Xg7V9KAbsaXtUPvKd5hoMHVLeoIc1M3AiSErCE98M9pnxCLDK8hXsJgJEgAgwHWD2gTF5iGRgUTOc/YKyb8jyFVyDafQDelgzQ0zbEz7+q3o/rVFPZuZEC2FuTnoh3MxJHcLdnMD4NfNgDyl9ATo0xZ9Ad/upAAAAAElFTkSuQmCC');
            background-repeat: no-repeat;
            background-size: contain;
            padding-top: 5px;
            border-top: 0.5px solid transparent;
            border-bottom: 0.2px solid transparent;
            box-sizing: content-box;
            background-position: center;
            /* content: '↑'; */
        }

        .left {
            width: calc(100vw - 300px);
            box-sizing: border-box;
            height: 100vh;
            position: relative;
        }

        .left>video {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 100%;
            height: 100%;
            min-width: 50%;
            min-height: 50%;
            margin: auto;
            padding: auto;
            position: relative;
        }

        .left>video:focus {
            outline: none;
            border: none;
        }

        .left>iframe {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            z-index: 3;
            position: relative;
        }

        .left #iframe-loading {
            color: white;
            font-size: 45px;
            width: 45px;
            height: 45px;
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-22.5px, -32px);
            transform-origin: center;
            z-index: 100;
            opacity: 1;
            transition: opacity 0.5s;
        }

        .left #iframe-loading.transparent {
            opacity: 0;
        }

        .spinning {
            animation: spinning 1.25s linear infinite;
            filter: drop-shadow(0px 0px 6px black);
            color: gray;
        }

        @keyframes spinning {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .hidden {
            display: none !important;
        }

        .right {
            width: 300px;
            box-sizing: border-box;
            padding: 20px;
            padding-right: 0;
            border-left: 2px solid rgba(255, 255, 255, 0.075);
            display: flex;
            flex-direction: column;
        }

        .right group {
            display: block;
            position: relative;
            width: calc(100% - 3px);
            height: 100%;
            padding-right: 13px;
            margin-right: 3px;
            color: white;
            /* background-color: rgba(255, 255, 255, 0.05); */
            background-color: transparent;
            overflow-x: hidden;
            overflow-y: visible;
            scroll-behavior: smooth;
            /* scroll-snap-type: proximity; */
            /* scroll-snap-align: center; */
            opacity: 0.2;
            transition: opacity .5s;
            /* display: flex;
            flex-direction: column; */
            scroll-snap-type: y proximity;
            box-sizing: border-box;
        }

        .right group::-webkit-scrollbar {
            background-color: #080808;
            width: 4px;
            height: 4px;
            /* display: none; */
        }

        ::-webkit-scrollbar-thumb {
            background-color: #363636;
            border-radius: 10px;
            cursor: default;
        }

        .right textarea {
            display: block;
            width: 100%;
            /* height: 100%; */
            height: fit-content;
            min-height: 30%;
            max-height: 110%;
            height: 40%;
            color: white;
            /* background-color: rgba(255, 255, 255, 0.05); */
            background-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, '更纱黑体 SC', '微软雅黑', 'Open Sans', 'Helvetica Neue', sans-serif;
            outline: none;
            border: none;
            box-sizing: border-box;
            resize: none;
            line-height: 1.5em;
            overflow-x: hidden;
            overflow-y: visible;
            scroll-behavior: smooth;
            /* opacity: 0.2; */
            transition: .5s opacity;
            resize: vertical;
            /* cursor: default; */
            border-bottom: 1px solid #808080;
            padding-bottom: 5px;
            margin-bottom: 10px;
            scroll-snap-align: start;
        }

        textarea:first-child {
            height: 60%;
        }

        .right textarea:only-of-type {
            height: calc(100% - 10px);
            resize: none;
            border-bottom: none;
        }

        .right textarea::placeholder {
            color: white;
            opacity: 1;
        }

        .right group.isactive {
            opacity: .5;
        }

        interaction {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 5px 0;
            padding: 12px 16px;
            box-sizing: border-box;
            background-color: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.35);
            text-align: center;
            cursor: pointer;
            user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -ms-user-select: none;
            /* border-radius: 3px; */
            -webkit-tap-highlight-color: rgba(255, 255, 255, 0.11);
            transition: .25s all;
        }

        interaction.half {
            width: 50%;
        }

        interaction[small] {
            padding: 8px 10px;
        }

        interaction[left] {
            text-align: left;
            justify-content: flex-start;
        }

        interaction:active {
            transform: scale(0.9);
        }

        .timecontrols,
        .filecontrols {
            margin-right: 20px;
        }

        .nodisplay {
            /* display: none !important; */
            visibility: hidden;
            flex-shrink: 100;
            max-width: 0;
            max-height: 0;
        }

        div.left.hasframe.bilibili .media-playback-percentage {
            display: none !important;
        }

        .media-playback-percentage {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            /* background: #00968822; */
            opacity: 0.15;
            transition: .25s all;
        }

        .media-playback-percentage:hover {
            opacity: .6;
            /* background-color: rgba(255, 255, 255, 0.24); */
        }

        #play-length {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 5px;
            max-width: 100%;
            /* width: 50%; */
            background: white;
            transition: 135ms width linear;
            /* border-radius: 0 4px 4px 0; */
        }

        .media-playback-timing {
            position: absolute;
            bottom: 10px;
            left: 6px;
            /* background: #00968822; */
            transition: .25s all;
            color: rgba(255, 255, 255, 0.6);
            z-index: 10;
            cursor: default;
        }

        /* #time-edt::after {
        content: "5s";
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        color: rgba(255, 255, 255, 0.35);
    } */

        iconlabel {
            display: inline;
            vertical-align: middle;
            margin-left: 8px;
        }

        .ms-Icon {
            vertical-align: middle;
            font-size: 18px;
        }

        noscript,
        noframes,
        div.error {
            display: flex;
            border: 2px solid currentColor;
            background-color: black;
            background-color: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(1px);
            color: rgb(255, 255, 0);
            box-sizing: border-box;
            padding: 12px 16px;
            opacity: .8;
            backdrop-filter: blur(2px);
            z-index: 20;
            flex-shrink: 0;
            justify-content: flex-start !important;
            user-select: none;
            -ms-user-select: none;
            -webkit-user-select: none;
            cursor: not-allowed;
        }

        noscript>i,
        noframes>i,
        div.error>i {
            font-size: 24px;
        }

        modal {
            content: '';
            position: fixed;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(1px);
            display: flex;
            align-items: center;
            z-index: 10000;
            transition: .25s all;
        }

        div.modal-card {
            display: block;
            margin: auto auto;
            width: 50%;
            min-width: 530px;
            height: 600px;
            max-height: calc(100vh - 50px);
            background: black;
            border: 2px solid rgb(92, 92, 92);
            color: rgba(255, 255, 255, 0.7);
            border-radius: 5px;
            position: relative;
            box-sizing: border-box;
            overflow-x: hidden;
            overflow-y: auto;
            transition: .25s all;
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .modal-content {
            box-sizing: border-box;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 25px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            border-radius: 0px;
        }

        .modal-content::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }

        .modal-card p {
            font-size: 15px;
        }

        .modal-card>.close-button {
            content: "×";
            font-size: 26px;
            line-height: 16px;
            position: absolute;
            top: 10px;
            right: 10px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            padding: 8px 14px 10px;
            background: rgba(34, 34, 34, 0.8);
            z-index: 10001;
        }

        .fadeout {
            opacity: 0;
        }

        .fadeout>.modal-card {
            transform: translateY(20vh) scale(0.5);
            opacity: 0;
        }

        code {
            color: rgb(250, 143, 124);
            border-bottom: 0.5px dotted currentColor;
            font-family: '等距更纱黑体 SC', 'Consolas', '等线', '微软雅黑', 'Courier New', Courier, monospace;
            /* border-radius: 3px; */
            margin: 0 5px;
        }

        select,
        input[type=text],
        label.input-file-alternative,
        input[type=button],
        button {
            padding: 8px 10px;
            border-radius: 2px;
            border: 1.5px solid rgb(92, 92, 92);
            background-color: rgba(255, 255, 255, 0.1);
            background: none;
            color: rgba(255, 255, 255, 0.65);
            transition: .1s all;
            box-sizing: content-box;
            display: flex;
            width: fit-content;
        }

        select,
        input[type=text],
        label.input-file-alternative,
        input[type=button],
        button {
            cursor: pointer;
            -webkit-tap-highlight-color: rgba(255, 255, 255, 0.3);
        }

        button>i:not([single]),
        label>i {
            vertical-align: middle;
            margin-right: 6px;
        }

        #openfile .modal-content div {
            display: flex;
            margin-bottom: 8px;
        }

        label.input-file-alternative {
            width: fit-content;
            border-radius: 0;
            margin-left: 6.5px;
            border-radius: 0 2px 2px 0;
            flex-shrink: 0;
        }

        input[type=text] {
            padding: 10px 14px;
        }

        select:focus,
        input[type=text]:focus,
        label.input-file-alternative:focus,
        input[type=button]:focus,
        label.input-file-alternative:hover,
        input[type=button]:hover,
        button:hover,
        button:focus {
            outline: none;
            border-color: rgb(143, 143, 143);
            background: rgba(255, 255, 255, 0.1);
            z-index: 10;
        }



        #URLtextbox {
            border-radius: 2px 0 0 2px;
            flex-grow: 10;
            /* flex-shrink: 0; */
            width: 100%;
        }

        #URLopen,
        #URLpaste {
            margin-left: -1.5px;
            border-radius: 0;
            flex-shrink: 0;
        }

        input[type=file] {
            visibility: hidden;
            zoom: 0;
            max-width: 0;
            max-height: 0;
            display: none;
        }


        option {
            background-color: rgba(255, 255, 255, 0.1);
            /* color: rgba(255, 255, 255, 0.65); */
            color: initial;
            /* margin-bottom: 5px; */
        }

        setting {
            display: block;
            line-height: 40px;
        }

        setting>* {
            vertical-align: middle;
        }

        label:not(.no-custom) {
            /* font-size: larger; */
            margin-inline-start: 5px;
            /* font-weight: bold; */
            vertical-align: middle;
            user-select: none;
        }

        input[type=checkbox] {
            width: 20px;
            height: 20px;
            opacity: .8;
        }

        help {
            display: inline;
            border-bottom: rgb(92, 92, 92) solid 1px;
            cursor: pointer;
        }

        @media (max-width: 600px) {
            #open-network-url {
                flex-wrap: wrap;
                justify-content: flex-end;
            }

            #URLopen,
            #URLpaste,
            label.input-file-alternative {
                margin-top: -1.5px;
            }

            #URLopen {
                border-radius: 0 0 2px 0;
            }

            #URLpaste {
                border-radius: 0 0 0 2px;
            }

            label.input-file-alternative {
                border-radius: 0 0 2px 2px;
            }

        }


        @media (max-width: 1024px) and (max-aspect-ratio: 6/5) {

            /* Portrait, no keyboard */
            body {
                flex-direction: column;
            }

            div.left {
                width: 100%;
                height: auto;
                min-height: 30vh;
                max-height: 50vh;
                padding: 40px 0;
                position: sticky;
                top: 0;
                transition: .25s all;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            div.left.hasframe {
                padding: 0;
            }

            .left>video {
                height: initial;
                max-height: 100%;
                width: 100%;
                transition: .25s all;
            }

            .left>iframe {
                min-height: 50vh;
                display: block;
            }

            div.left.hasframe.bilibili iframe {
                min-height: 40vh;
                display: block;
                z-index: 101;
            }

            .right {
                border-top: 2px solid rgba(255, 255, 255, 0.075);
                flex-direction: column-reverse;
                width: 100%;
                height: calc(60vh);
                border-left: none;
                transition: .25s all;
                padding: 20px !important;
                z-index: 10;
            }

            .right>div {
                width: 100%;
                flex-shrink: 0;
                display: flex;
                justify-content: space-between;
            }

            .right group {
                columns: 100vw auto;
                column-fill: auto;
                scroll-snap-type: x mandatory;
                overflow-x: scroll;
                overflow-y: hidden;
                margin-top: 15px;
                padding-right: 0;
                margin-right: 0;
            }

            .right textarea {
                scroll-snap-align: start;
                flex-shrink: 1;
                /* margin-top: 15px; */
                /* margin-bottom: 0; */
                border-top: 2px solid rgba(255, 255, 255, 0.205);
                padding-top: 15px;
                height: calc(100% - 4px);
                margin: 0;
                border-bottom: 0;
                resize: none;
            }

            textarea:first-child {
                height: calc(100% - 4px);
            }

            .right textarea::-webkit-resizer {
                display: none;
            }

            .right group::-webkit-scrollbar {
                background-color: #080808;
                width: 12.5px;
                height: 7.5px;
                display: block;
            }

            .right group::-webkit-scrollbar {
                background-color: #080808;
                display: block;
            }

            .timecontrols,
            .filecontrols {
                margin-right: 20px;
            }

            iconlabel:not(.important) {
                display: none !important;
            }

            noscript,
            div.error.fix {
                position: fixed;
                bottom: 5px;
                left: 5px;
                width: calc(100% - 10px);
                z-index: 1000;
            }

            modal div.modal-card {
                min-width: unset;
                width: calc(100% - 40px);
                max-height: calc(100% - 40px);
                font-size: smaller;
                /* height: initial; */
            }

            modal .modal-card .modal-content {
                padding-bottom: 25px;
            }

            .logo {
                zoom: 0.65;
            }
        }

        @media (max-width: 700px) and (max-aspect-ratio: 6/5) and (min-aspect-ratio: 4/5) {

            /* Portrait, Keyboard on or on square devices */
            div.left {
                padding: 0 0 !important;


            }

            div.right {
                padding-top: 10px;
            }

            .right group {
                padding-top: 0;
                margin: 0;
            }

            .right textarea {
                margin-top: 0px;
                padding-top: 10px;
                border-top: none;
            }

            .right>div:not(.error) {
                max-height: 0;
            }

            .right>div>div.timecontrols {
                display: none !important;
            }

            .right>div>div.filecontrols {
                display: none;
                position: fixed;
                top: 6px;
                right: 6px;
                transform: scale(0.85);
                transform-origin: top right;
            }

            #settings-btn {
                display: none;
            }

            #playpause {
                display: flex !important;
                z-index: 100;
                width: fit-content;
            }

            div.error.fix {
                max-height: initial;
            }

            .left>video {
                width: 85%;
                margin: 0 auto;
            }
        }

        @media (max-width: 1024px) and (min-aspect-ratio: 3/1) {

            /* Landscape, keyboard on */
            .timecontrols {
                display: none !important;
            }

            .right>div>div.filecontrols {
                display: none;
                position: fixed;
                top: 6px;
                right: 310px;
                transform: scale(0.85);
                transform-origin: top right;
                flex-direction: column;
                align-items: flex-end;
            }

            .right {
                padding-top: 0;
            }

            .right group {
                columns: 100vw auto;
                column-fill: auto;
                scroll-snap-type: x mandatory;
                overflow-x: scroll;
                overflow-y: hidden;
                margin-top: 15px;
            }

            .right textarea {
                scroll-snap-align: start;
                flex-shrink: 1;
                /* margin-top: 15px; */
                /* margin-bottom: 0; */
                /* border-top: 2px solid rgba(255, 255, 255, 0.205); */
                padding-top: 15px;
                height: calc(100% - 4px);
                margin: 0;
                border-bottom: 0;
                resize: none;
            }

            .right group::-webkit-scrollbar {
                background-color: #080808;
                width: 12.5px;
                height: 7.5px;
                display: block;
            }

            #playpause {
                display: flex !important;
                z-index: 100;
                width: fit-content;
                margin-right: 0 !important;
            }

            #settings-btn {
                display: none;
            }

        }
    </style>
    <style>
        .logo {

            /* background-image:  */
            background-image: var(--image);

            width: 100px;
            height: 90px;
            float: right;
            /* margin: 15px; */
            background-clip: border-box;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            margin-right: 15px;
        }

        @media (max-width: 450px) {
            #what-card {
                flex-direction: column;
                /* align-items: flex-start; */
            }

            #what-card>div:nth-child(2) {
                margin-left: none !important;
                text-align: center;
            }

            .logo {
                margin-right: 0;
            }
        }
    </style>
</head>

<body>
    <div class="left">
        <video src="about:blank"></video>
        <iframe src="" allow="fullscreen" frameborder="0" class="hidden">
            <div class="error">
                <i class="ms-Icon ms-Icon--Error" aria-hidden="true"></i>
                <iconlabel class="important">您的浏览器不支持 iframe。<br>本功能将无法正常工作。<br>是时候换个好一点的浏览器了！</iconlabel>
            </div>
        </iframe>
        <div id="iframe-loading" class="hidden"><i class="ms-Icon ms-Icon--WebAppBuilderModule spinning" style="font-size: 45px;" aria-hidden="true"></i></div>
        <div class="media-playback-percentage">
            <div id="play-length"></div>
            <div class="media-playback-timing"></div>
        </div>
    </div>
    <div class="right">
        <group>
            <textarea name="" id="ta1" cols="30" rows="5" placeholder="正在加载中···\n\n如果您长时间看到此提示，网页可能工作不正常。"></textarea>
            <!-- <textarea name="" id="ta2" cols="30" rows="5" placeholder="texttext"></textarea>
            <textarea name="" id="ta3" cols="30" rows="5" placeholder="texttext"></textarea>
            <textarea name="" id="ta4" cols="30" rows="5" placeholder="texttext"></textarea> -->
        </group>
        <noscript>
            <i class="ms-Icon ms-Icon--StatusErrorFull" aria-hidden="true"></i>
            <iconlabel class="important">JavaScript 未被启用。<br>本网页将无法正常工作。<br>如果您已启用 JavaScript 页面却未工作，请下载网页后用浏览器打开。</iconlabel>
        </noscript>
        <div class="error fix hidden" id="ie-warning">
            <i class="ms-Icon ms-Icon--DRM" aria-hidden="true"></i>
            <iconlabel class="important">本网页不支持 Internet Explorer，无法正常工作。<br>建议更换 Chromium 内核的浏览器。</iconlabel>
        </div>

        <div>
            <div style="display: flex;position: relative;" id="time-edt" class="nodisplay timecontrols">
                <interaction class="half" onclick="videoPlayer.seek(-5)"><i class="ms-Icon ms-Icon--DoubleChevronLeft8" aria-hidden="true"></i></interaction>
                <interaction class="half" onclick="videoPlayer.jump()"><i class="ms-Icon ms-Icon--SIPMove" aria-hidden="true"></i></interaction>
                <interaction class="half" onclick="videoPlayer.seek(5)"><i class="ms-Icon ms-Icon--DoubleChevronRight8" aria-hidden="true"></i></interaction>
            </div>
            <div style="display: flex;flex-shrink: 0;" class="filecontrols">
                <interaction onclick="togglePlayPause()" left id="playpause" style="flex-shrink: 1.4; margin-right: 6px;">
                    <i class="ms-Icon ms-Icon--OpenFile" aria-hidden="true"></i>
                    <iconlabel class="important">打开</iconlabel>
                </interaction>
                <!-- <interaction onclick="toggleInfo()" id="info" style="width: 50px"><i class="ms-Icon ms-Icon--Info" aria-hidden="true"></i>
                </interaction> -->
                <interaction id="settings-btn" data-modal="settings" style="width: 50px"><i class="ms-Icon ms-Icon--Settings" id="settings-icon" aria-hidden="true"></i>
                </interaction>
                <interaction onclick="gui.fullscreen.toggle()" id="fullscreen" style="width: 50px"><i class="ms-Icon ms-Icon--FullScreen" aria-hidden="true"></i>
                </interaction>
            </div>
        </div>
    </div>
    <modal id="openfile" class="hidden fadeout">
        <div class="modal-card">
            <div class="close-button">×</div>
            <div class="modal-content">
                <h2>打开文件</h2>
                <div id="open-network-url">
                    <input type="text" placeholder="输入视频网站链接 / 视频 URL / 以'||'为开头的页面地址" id="URLtextbox"></input>
                    <button id="URLpaste" title="粘贴"><i class="ms-Icon ms-Icon--Paste" aria-hidden="true" single></i></button>
                    <button id="URLopen" title="打开" onclick="onSubmitVideoURL()"><i class="ms-Icon ms-Icon--Forward" aria-hidden="true" single></i></button>
                    <label for="openlf" class="input-file-alternative no-custom"><i class="ms-Icon ms-Icon--OpenFolderHorizontal" aria-hidden="true"></i><span style="vertical-align: center;">本地选取文件</span></label>
                    <!-- <input type="button" value='<i class= ms-Icon ms-Icon--OpenFile' aria-hidden='true'\>\<\/i\>打开" id="URLopen"></input> -->
                </div>
                <input type="file" name="openlf" id="openlf" accept="video/mp4, .html, .pdf, .swf">
                <!-- <p id="grant-clipboard">建议您先允许剪贴板权限。<help onclick="settingUtils.interaction.grantClipboard()">点击以允许</help>
                </p> -->
                <p id="file-info" class="hidden"></p>
                <p>您可以从本地选取文件，或粘贴视频网站链接/视频源文件链接。<help data-modal="settings">查看帮助</help>
                </p>
            </div>
        </div>
    </modal>
    <modal id="info" class="hidden fadeout">
        <div class="modal-card" style="height: fit-content;">
            <div class="close-button">×</div>
            <div class="modal-content">
                <h1>信息</h1>
                <p style="line-height: 1.5em;font-size: larger;">...</p>
            </div>
        </div>
    </modal>
    <modal id="settings" class="hidden fadeout">
        <div class="modal-card">
            <div class="close-button">×</div>
            <div class="modal-content">
                <div class="error hidden" id="localStorage-error">
                    <i class="ms-Icon ms-Icon--InfoSolid" aria-hidden="true"></i>
                    <iconlabel class="important">当前浏览器不支持 localStorage，您记下的笔记不会被缓存，设置不会被保存，在离开页面时我们也会提醒您。<br>建议更换 Chromium 内核的浏览器。</iconlabel>
                </div>
                <div style="display: flex;align-items: center;padding: 10px 14px; background-color: rgb(51, 51, 51);border-radius: 5px;" id="what-card">
                    <div class="logo">
                        <!-- <img src="./VideoNotes.svg" alt="" style="width: 100%;height: 100%;"> -->
                    </div>
                    <div>
                        <h3 style="margin: 0.1em 0 0.5em;">VideoNotes 1.7.0</h3>
                        <p style="margin: 0 0 0.5em;">@smallg0at 编写, 2020/3/23</p>
                        <p style="margin: 0 0 0.5em;">服务器由 @steven12138z 提供</p>
                    </div>
                </div>
                <h3>设置</h3>
                <setting>
                    <select name="bilibili-ext" id="bilibili-ext" style="display: inline-block;">
                        <option value="0">B站小播放器（不支持720P以上）</option>
                        <option value="1">贝贝解析（默认）（无法更换画质）</option>
                    </select>
                    <label for='bilibili-ext'>B站解析接口</label>
                </setting>
                <setting>
                    <input type="checkbox" name="enable-force-method" id="enable-force-method" style="width: 20px;height: 20px">
                    <label for="enable-force-method">启用暴力的本地文件读取方式（不建议开启）</label>
                </setting>
                <interaction style="color: rgba(255, 255, 0, 0.5); width: fit-content;" small onclick="settingUtils.reset()">
                    <i class="ms-Icon ms-Icon--Delete" aria-hidden="true"></i>
                    <iconlabel class="important">重置设置与所有笔记</iconlabel>
                </interaction>
                <h3>打开文件帮助</h3>
                <p>打开暴力方法后，请<strong>务必不要打开100MB以上的本地文件</strong>，否则页面可能崩溃</p>
                <p>
                    以下类型可用：
                </p>
                <ul>
                    <li>bilibili 视频：复制视频链接 或 输入av或bv号即可自动解析，支持分P不支持切换，不支持看番。</li>
                    <li>acfun 视频：复制视频链接 或 输入ac号（如ac0000000）即可自动解析，由于内嵌播放器缘故不支持分P（默认1P），不支持看番。手机横屏观看时不建议全屏。</li>
                    <li>网页：先输入 <code>||</code> 后面直接跟网页链接（二者间不可带空格）。有些网站可能拒绝接受iframe。</li>
                    <li>mp4 视频：输入视频URL即可。打开视频后如需再次打开，请刷新页面。</li>
                </ul>
                <p>
                    以下类型不可用：
                </p>
                <ul>
                    <li>flv：未来会做</li>
                </ul>
                <h3>笔记区帮助</h3>
                <p>在大尺寸设备上，笔记在不操作时会变暗。此时，可选中笔记区后 上下滚动/进行选择/任意击键，或在页面内其他位置戳<code>Ctrl</code>。</p>
                <h3>声明</h3>
                <p>本程序“按原样”提供，不会收集您的个人信息；但通过框架访问的网页无法控制，这类问题与我们无关。</p>
            </div>
        </div>
    </modal>
</body>
<script id="settings-setup">
    'use strict';
    //info: this should be written with compatibility.
    const DEBUGMODE = {
        keypress: false,
        inspectGeneratedURL: false,
        setting: false
    }
    var settings = {
        isIE: false,
        localStorage: true,
        allowExperimentalAPI: {
            bilibili: 1
        },
        hasPasteApi: true,
        hasPermission: true,
        enableBruteForce: false,
        usingNW: false
    }
    var settingUtils = {
        read: function() {
            if (settings.localStorage) {
                if (localStorage.VNSettings != 'null' && localStorage.VNSettings) {
                    settings = JSON.parse(localStorage.VNSettings)
                    if (DEBUGMODE.setting) {
                        console.log('READ:', JSON.parse(localStorage.VNSettings))
                    }

                } else {
                    localStorage.VNSettings = JSON.stringify(settings)
                    if (DEBUGMODE.setting) {
                        console.log('READ:FW', JSON.parse(localStorage.VNSettings))
                    }
                }
                this.onRead()
            }
        },
        onRead: function() {
            document.querySelector('#bilibili-ext').selectedIndex = settings.allowExperimentalAPI.bilibili
            document.querySelector('#bilibili-ext').onchange = function() {
                settings.allowExperimentalAPI.bilibili = document.querySelector('#bilibili-ext').selectedIndex
                settingUtils.write()
            }
            if (settings.enableBruteForce) {
                console.log()
                document.querySelector('#enable-force-method').checked = true
            }
            document.querySelector('#enable-force-method').onchange = function() {
                settings.enableBruteForce = document.querySelector('#enable-force-method').checked
                settingUtils.write()
            }
        },
        write: function() {
            if (settings.localStorage) {
                localStorage.VNSettings = JSON.stringify(settings)
                if (DEBUGMODE.setting) {
                    console.log('WRITE:', JSON.parse(localStorage.VNSettings))
                }
            }
        },
        reset: function() {
            if (settings.localStorage) {
                if (confirm('确认清除设置与笔记？本操作无法撤销！')) {
                    localStorage.videoNotes = ''
                    localStorage.VNSettings = ''
                    alert('清除完毕，页面将会刷新。')
                    location.reload()
                }
            } else {
                alert('没有资源能被重置。')
            }
        },
        interaction: {
            onDisableLocalStorage: function() {
                document.getElementById('localStorage-error').classList.remove('hidden')
                document.getElementById('settings-icon').style.color = 'rgb(92,92,0)';
                settings.localStorage = false;
            },
            checkIfIE: function() {
                if (navigator.userAgent.indexOf('Trident') != -1 && navigator.userAgent.indexOf('Edge') == -1) {
                    console.log(navigator.userAgent)
                    document.getElementById('ie-warning').classList.remove('hidden')
                    settings.isIE = true
                }
            },
            checkLS: function() {
                try {
                    let a = localStorage.videoNotes
                } catch (e) {
                    this.onDisableLocalStorage()
                    console.info('LocalStorage is now DISABLED due to exception')
                    // console.warn(e)
                }
            },
            grantClipboard: function() {
                if (navigator.clipboard) {
                    navigator.clipboard.readText()
                } else {
                    console.warn('Clipboard API is not available')
                }
            },
            checkPasteAPI: function() {
                if (!navigator.clipboard) {
                    document.querySelector('#URLpaste').classList.add('hidden');
                    settings.hasPasteApi = false
                }
            },
            checkNW: function() {
                if (nw) {
                    settings.usingNW = true
                }
            }
        }
    }
    settingUtils.interaction.checkLS()
    settingUtils.read()

    settingUtils.interaction.checkIfIE()
    settingUtils.interaction.checkPasteAPI()
    settingUtils.interaction.checkNW()

    settingUtils.write()

    if (settings.usingNW) {
        var nwWindow = nw.Window.get()
        var nwClip = nw.Clipboard.get()
    } else {
        var nwWindow = null
        var nwClip = null
    }
</script>


<script id="main-controller">
    'use strict';
    // console.log('ran script')
    document.querySelector('video').src = "";
    var textareaItem = document.querySelector('textarea');
    var frameCount = 0;


    let videoIsAvailable = false;
    var gui = {
        el: {
            left: document.querySelector('.left'),
            right: document.querySelector('.right')
        },
        updateRightHeight: function() {
            if (window.innerWidth <= 1024) {
                let leftComp = window.getComputedStyle(document.querySelector('.left'))
                let leftHeight = parseInt(leftComp.getPropertyValue('height'))
                document.querySelector('.right').style.height = (window.innerHeight - leftHeight - 5) + 'px'
            } else {
                document.querySelector('.right').setAttribute('style', '')
            }
        },
        setInnerIcon: function(query, iconName, extraLabel = null, important = false) {
            document.querySelector(query).innerHTML = `<i class="ms-Icon ms-Icon--${iconName}" aria-hidden="true"></i>${(extraLabel ? `<iconlabel${(important ? ' class="important"' : '')}>${extraLabel}</iconlabel>` : '')}`
        },
        fullscreen: {
            toggle: function() {
                console.log(settings.usingNW)
                if (settings.usingNW) {
                    nwWindow.toggleFullscreen()
                    if (!nwWindow.isFullscreen) {
                        gui.setInnerIcon('#fullscreen', 'BackToWindow')
                        // document.querySelector('#fullscreen').innerHTML = "退出全屏"
                    } else {
                        gui.setInnerIcon('#fullscreen', 'FullScreen')
                        // document.querySelector('#fullscreen').innerHTML = "全屏"
                    }
                } else {
                    if (document.fullscreenElement) {
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        } else if (document.mozCancelFullScreen) {
                            document.mozCancelFullScreen();
                        } else if (document.msExitFullscreen) {
                            document.msExiFullscreen();
                        } else if (document.webkitCancelFullScreen) {
                            document.webkitCancelFullScreen();
                        }
                    } else {
                        if (document.documentElement.requestFullscreen) {
                            document.documentElement.requestFullscreen();
                        } else if (document.documentElement.mozRequestFullScreen) {
                            document.documentElement.mozRequestFullScreen();
                        } else if (document.documentElement.msRequestFullscreen) {
                            document.documentElement.msRequestFullscreen();
                        } else if (document.documentElement.webkitRequestFullscreen) {
                            document.documentElement.webkitRequestFullScreen();
                        }
                    }
                }
            },
            onChange: function(forceValue = null) {
                console.log(forceValue)
                if (document.fullscreenElement || document.fullscreen) {
                    gui.setInnerIcon('#fullscreen', 'BackToWindow')
                    // document.querySelector('#fullscreen').innerHTML = "退出全屏"
                } else {
                    gui.setInnerIcon('#fullscreen', 'FullScreen')
                    // document.querySelector('#fullscreen').innerHTML = "全屏"
                }
            }
        }
    }
    window.onresize = gui.updateRightHeight()
    document.onfullscreenchange = gui.fullscreen.onChange()
    gui.updateRightHeight()


    var notes = {
        container: document.querySelector('group'),
        activeTimeout: -1,
        item: (id = 0) => {
            return document.querySelectorAll('textarea').item(id)
        },
        load: () => {
            if (settings.localStorage) {
                textareaItem.value = localStorage.videoNotes || ""; //拿到存储的文本
            }
        },
        save: () => {
            if (settings.localStorage) {
                localStorage.videoNotes = textareaItem.value
            }
        },
        setActive: function(force = false) {
            this.save()
            this.container.classList.add('isactive');
            try {
                clearTimeout(this.activeTimeout)
            } catch (error) {
                console.error(error)
            }
            if (textareaItem.value != "" && !force && window.innerWidth > 1024) {
                this.activeTimeout = setTimeout(() => {
                    this.container.classList.remove('isactive')
                }, 2500);
            }
        },
        init: function() {
            this.load()
            this.item().onscroll = () => notes.setActive()
            this.item().onselectionchange = () => notes.setActive()
            this.item().onselect = () => notes.setActive()
            // this.item().ontouchstart = ()=>textAreaSetActive(true)
            this.item().ontouchmove = () => notes.setActive()
            this.item().ontouchend = () => notes.setActive()
            this.container.onscroll = () => notes.setActive()
        },
        onFinishLoad: function() {
            this.item().placeholder = '在这里记点笔记吧。' + (settings.localStorage ? '' : '\n\n您的浏览器暂不支持本地存储，因此您的文本在刷新时不会被保留！')
        }
    }
    notes.init()

    let DBGcurrentFile = null
    var openFile = {
        el: {
            filePicker: document.querySelector('input[type=file]'),
            textBox: document.querySelector('#URLtextbox'),
            openButton: document.querySelector('#URLopen')
        },
        gui: {
            pasteContent: async function(e) {
                e.preventDefault()
                if (settings.usingNW) {
                    document.querySelector('#URLtextbox').value = nwClip.get()
                } else {
                    if (navigator.clipboard) {
                        // document.querySelector('#URLtextbox').value = await navigator.clipboard.readText();
                        navigator.clipboard.readText()
                            .then((text) => {
                                document.querySelector('#URLtextbox').value = text
                            })
                            .catch(err => {
                                // This can happen if the user denies clipboard permissions:
                                document.querySelector('#URLpaste').classList.add('hidden')
                            });
                    } else {
                        document.querySelector('#URLtextbox').value = clipboardData.getData('Text')

                    }
                }
                document.querySelector('#URLtextbox').select()
            },

        },
        open: {
            local: function() {
                var selectedFile = openFile.el.filePicker.files.item(0)
                console.log(selectedFile)
                var {
                    name,
                    size,
                    type
                } = selectedFile
                DBGcurrentFile = selectedFile
                console.log("文件名:" + name + " 大小:" + size);
                document.querySelector('#file-info').innerHTML = `⏳ ${name}（${(size/1000000).toFixed(1)}MB）${(settings.enableBruteForce?' 正在加载中...':'')} ${size >= 100000000 && settings.enableBruteForce?'<br>文件过大，可能加载失败或页面崩溃。':''}`
                document.querySelector('#file-info').classList.toggle('hidden')
                if (settings.enableBruteForce) {
                    var reader = new FileReader(); //这是核心,读取操作就是由它完成.
                    console.log('BruteForce: init')
                    reader.readAsDataURL(selectedFile)
                    reader.onload = function() {
                        console.log('BruteForce: done, ' + this.result.length)
                        if (this.result.length == 0) {
                            alert('此文件没有内容或过大，加载失败。')
                        } else {
                            openFile.open.loadLocal(this.result, '', name)
                        }
                    }
                } else {
                    openFile.open.loadLocal(URL.createObjectURL(selectedFile), type, name)
                }
            },
            loadLocal: function(url = '', type = new String(), name = '') {
                setTimeout(() => {
                    if (url.startsWith('data:video/') || type.startsWith('video/')) {
                        videoPlayer.activate(url, name)
                    } else {
                        webFrame.load(url)
                    }

                    modal.close('openfile')
                }, 350)
            }
        }
    }
    openFile.el.filePicker.onchange = () => {
        openFile.open.local()
    }

    document.querySelector('#URLpaste').onclick = (event) => openFile.gui.pasteContent(event)

    var shortcut = {
        list: new Map(),
        count: 0,
        add: function(key, func) {
            return this.list.set(key, func)
        },
        check: function(key) {
            return this.list.has(key)
        },
        apply: function() {
            document.onkeyup = (event) => {
                if (DEBUGMODE.keypress) {
                    console.log('KEYUP:', event)
                }
                this.count++
                if (this.list.has('any')) {
                    let a = this.list.get('any')
                    a(event)
                }
                if (this.list.has(event.key)) {
                    let a = this.list.get(event.key)
                    a(event)
                }
            }
        }
    }

    { // func: Set up shortcut
        shortcut.add('Control', (event) => {
            notes.setActive()
        })
        shortcut.add(' ', (event) => {
            if (event.target.tagName != 'TEXTAREA' && event.target.tagName != 'INPUT') {
                togglePlayPause()
            }
        })
        shortcut.add('F11', (event) => {
            event.preventDefault()
        })
        shortcut.add('Enter', (event) => {
            if (event.target.id == 'URLtextbox') {
                onSubmitVideoURL()
            }
        })
        shortcut.add('o', (event) => {
            if (event.target.tagName != 'TEXTAREA' && event.target.tagName != 'INPUT') {
                event.preventDefault()
                modal.isOpen('openfile') ? modal.close('openfile') : modal.open('openfile')
            }
        })
        shortcut.add('any', (event) => {
            if (event.target.tagName == 'TEXTAREA') {
                notes.setActive()
            }
        })

        shortcut.apply()
    }


    document.onkeydown = (event) => {
        if (DEBUGMODE.keypress) {
            console.log('KEYDN:', event)
        }
        if (event.key == 'Control') {
            notes.setActive(true)
        }
    }

    notes.setActive()

    setInterval(() => { //refreshes every 100ms, setting time bar
        if (frameCount >= 0) {
            if (videoPlayer.isAvailable) {
                let mediaPlayback = videoPlayer.el
                document.querySelector('#play-length').setAttribute('style', 'width: ' + (mediaPlayback.currentTime / mediaPlayback.duration * 100).toFixed(2) + '%;');
                let existstr = Math.floor(mediaPlayback.currentTime / 60) + ':' + Math.floor(mediaPlayback.currentTime % 60)
                let totalstr = Math.floor(mediaPlayback.duration / 60) + ':' + Math.floor(mediaPlayback.duration % 60)
                document.querySelector('.media-playback-timing').innerHTML = existstr + ' / ' + totalstr
            }
        }
        frameCount++
        gui.updateRightHeight()
    }, 100)
    window.onbeforeunload = () => {
        if (!settings.localStorage && textareaItem.value != "") {
            return '文本框内仍有内容，确认离开？'
        }
    }




    function videoUrlParser(url = new String()) {
        let targetURL;
        let frame = document.querySelector('iframe')
        var videoElement = document.querySelector('video')
        var label = document.querySelector('#playpause')
        let lowURL = url.toLocaleLowerCase()
        if ((lowURL.startsWith('av') || lowURL.startsWith('bv') || url.indexOf('www.bilibili.com/video/') != -1 || url.indexOf('b23.tv/') != -1) && (!url.startsWith('||'))) {
            //bilibili mode
            // targetURL = 'https://www.bilibili.com/blackboard/newplayer.html?aid=' + targetURL
            if (settings.allowExperimentalAPI.bilibili == 1) {
                targetURL = 'http://xbeibeix.com/api/bilibilivideo.php?url=' + url
                // let req = new XMLHttpRequest()
            } else {
                targetURL = url.replace('www.bilibili.com/video/', '')
                targetURL = targetURL.replace('b23.tv/', '')
                targetURL = targetURL.replace('https://', '')
                targetURL = targetURL.replace('?p=', '&page=')
                targetURL = targetURL.replace('?', '&')
                if (lowURL.indexOf('bv') != -1) {
                    targetURL = targetURL.replace('BV', '')
                    targetURL = targetURL.replace('bv', '')
                    targetURL = 'https://player.bilibili.com/player.html?bvid=' + targetURL + '&high_quality=1'
                } else {
                    targetURL = targetURL.replace('av', '')
                    targetURL = 'https://player.bilibili.com/player.html?aid=' + targetURL + '&high_quality=1'
                }
            }
            if (DEBUGMODE.inspectGeneratedURL) {
                console.log('ParseURL', 'bilibili', targetURL)
            }
            return {
                mode: 'bilibili',
                parsed: targetURL,
                interaction: function() {
                    webFrame.load(targetURL, true)
                }
            }

        } else if ((url.startsWith('ac') || url.indexOf('www.acfun.cn/v/') != -1 || url.indexOf('m.acfun.cn/v/') != -1) && (!url.startsWith('||'))) {
            if (url.indexOf('m.acfun.cn') != -1) {
                targetURL = url.replace('https://m.acfun.cn/v/?ac=', '')
                targetURL = targetURL.substr(0, targetURL.indexOf('&'))
            } else {
                targetURL = url.replace('www.acfun.cn/v/', '')
                targetURL = targetURL.replace('https://', '')
                targetURL = targetURL.replace('ac', '')
                targetURL = targetURL.substr(0, targetURL.indexOf('_'))
            }
            // targetURL = targetURL.replace('?p=', '&page=')
            targetURL = 'https://www.acfun.cn/player/ac' + targetURL
            if (DEBUGMODE.inspectGeneratedURL) {
                console.log('ParseURL', 'acfun', targetURL)
            }
            return {
                mode: 'acfun',
                parsed: targetURL,
                interaction: function() {

                    if (window.innerWidth <= 600) {
                        alert('acfun 网页播放器在手机上效果不一定正常。')
                    }
                    webFrame.load(targetURL, true)
                }
            }
        } else if (url.indexOf('web.microsoftstream.com/video/') != -1 && !url.startsWith('||')) {

            targetURL = url.replace('web.microsoftstream.com/video/', 'web.microsoftstream.com/embed/video/')
            // targetURL = targetURL.replace('?p=', '&page=')
            if (targetURL.indexOf('?st=') != -1) {
                targetURL = targetURL + '&autoplay=true&amp;showinfo=false'
            } else {
                targetURL = targetURL + '?autoplay=true&amp;showinfo=false'
            }
            if (DEBUGMODE.inspectGeneratedURL) {
                console.log('ParseURL', 'msstream', targetURL)
            }
            return {
                mode: 'ms-stream',
                parsed: targetURL,
                interaction: function() {
                    webFrame.load(targetURL, true)
                    document.querySelector('.left').classList.add('bilibili')
                }
            }
        } else if (url.startsWith('||')) {
            targetURL = url.replace('||', '');
            if (DEBUGMODE.inspectGeneratedURL) {
                console.log('ParseURL', 'frame', targetURL)
            }
            return {
                mode: 'frame',
                parsed: targetURL,
                interaction: function() {
                    webFrame.load(targetURL, false)
                    document.querySelector('.left').classList.remove('bilibili')
                }
            }
            // } else if (url.startsWith('blob:')) {
            //     return {
            //         mode: 'blob',
            //         error: 'Blob is not supported by now.'
            //     }

        } else {
            return {
                mode: 'video',
                parsed: url,
                interaction: function() {
                    if (DEBUGMODE.inspectGeneratedURL) {
                        console.log('ParseURL', 'video', url)
                    }
                    videoPlayer.activate(url)
                }
            }
        }
    }
    var webFrame = {
        url: () => {
            this.el.src
        },
        el: document.querySelector('iframe'),
        load: function(url = '', isOnlineStream = false) {
            document.title = 'VideoNotes - Loading...'
            document.querySelector('video').classList.add('hidden')
            if (isOnlineStream) {
                document.querySelector('.left').classList.add('bilibili')
            } else {
                document.querySelector('.left').classList.remove('bilibili')
            }
            this.el.classList.remove('hidden')
            this.el.src = url
            gui.el.left.classList.add('hasframe')
            document.querySelector('#iframe-loading').classList.remove('hidden')
        },
        unload: function() {
            gui.el.left.classList.remove('hasframe')
            gui.el.left.classList.remove('bilibili')
            this.el.classList.add('hidden')
            this.el.src = ""
        }
    }
    webFrame.el.contentWindow.onbeforeunload = () => {
        document.querySelector('#iframe-loading').classList.remove('hidden')
        document.querySelector('#iframe-loading').classList.remove('transparent')
    }
    webFrame.el.onload = function() {
        document.title = 'VideoNotes - ' + webFrame.el.contentWindow.document.title
        document.querySelector('#iframe-loading').classList.add('transparent')
        setTimeout(() => {
            document.querySelector('#iframe-loading').classList.replace('transparent', 'hidden')
        }, 1050)
    }
    webFrame.el.contentWindow.onerror = function() {
        alert('加载页面内容时出现了点问题，请稍后再试。')
        self.onload()
    }

    function onSubmitVideoURL() {
        let inputURL = openFile.el.textBox.value
        if (inputURL) {
            let res = videoUrlParser(inputURL)
            document.querySelector('#file-info').innerHTML = '⏳ 正在处理链接并加载中...'
            openFile.el.textBox.disabled = true
            document.querySelector('#file-info').classList.toggle('hidden')
            if (!res.error) {
                setTimeout(() => {
                    modal.close('openfile')
                    res.interaction()
                    document.querySelector('#file-info').classList.toggle('hidden')
                    openFile.el.textBox.disabled = false
                    openFile.el.textBox.value = ""

                }, 500)
            } else {
                console.error(res.error)
                gui.setInnerIcon('#playpause', 'Error', '重新打开', true)
                alert(res.error)
            }
        }
    }


    function togglePlayPause() { //onclick playpause button
        if (videoPlayer.el.src == window.location.href || videoPlayer.inError) {
            modal.open('openfile')
        } else {
            videoPlayer.isPaused() ? videoPlayer.play() : videoPlayer.pause()
        }
    }

    var videoPlayer = {
        el: document.querySelector('video'),
        isAvailable: false,
        inError: false,
        isPaused: function() {
            return this.el.paused
        },
        play: function() {
            this.el.play()
        },
        pause: function() {
            this.el.pause()
        },
        onError: function(e) {
            gui.setInnerIcon('#playpause', 'Error', '打开', true)
            this.el.onplay = null
            this.el.onpause = null
            this.el.pause()
            this.inError = true
            this.isAvailable = false
            let f = JSON.stringify(e)
            console.log(f)
            document.title = 'VideoNotes - 错误'
            modal.custom.info.render(`很抱歉，视频播放时出现了错误。<br>当前正在播放：${e.srcElement.src}<br>Timestamp: ${e.timeStamp}<br>您可尝试刷新页面、重启浏览器、重启计算机解决。`, '出现错误')
            document.querySelector('#time-edt').classList.add('nodisplay')
            gui.updateRightHeight()
            throw e
        },
        activate: function(url, overrideTitle = '') {
            webFrame.el.classList.add('hidden')
            this.el.classList.remove('hidden')
            gui.el.left.classList.remove('hasframe')
            gui.el.left.classList.remove('bilibili')
            this.el.src = url
            this.inError = false
            document.querySelector('#time-edt').classList.remove('nodisplay')
            if (overrideTitle) {
                document.title = 'VideoNotes - ' + overrideTitle
            } else {
                document.title = 'VideoNotes - ' + this.el.src
            }
            this.isAvailable = true
            this.el.onerror = (e) => {
                this.onError(e)
            }
            this.el.onplay = () => {
                gui.setInnerIcon('#playpause', 'Pause', '暂停')
                // label.innerHTML = '暂停'
            }
            this.el.onpause = () => {
                gui.setInnerIcon('#playpause', 'Play', '播放')
                // label.innerHTML = '播放'
            }
            this.el.onended = () => {
                gui.setInnerIcon('#playpause', 'Play', '重放')
                // label.innerHTML = '重放'
            }
            this.el.play()
        },
        jump: function() {
            let pausedbef = this.isPaused()
            this.pause()
            let destTimeString = prompt('请输入目标秒数')
            if (destTimeString === null) {
                if (!pausedbef) {
                    this.play()
                }
            } else if (destTimeString == "") {

            } else {
                let destTime = parseInt(destTimeString)
                console.log(destTime)
                if (!isNaN(destTime)) {
                    videoElement.currentTime = destTime
                }
            }
        },
        seek: function(time) {
            this.el.currentTime += time
        }
    }

    var modal = {
        basezindex: 10000,
        elementList: function() {
            return document.querySelectorAll('modal')
        },
        custom: {
            info: {
                id: 'modal',
                render: function(html, title = "信息") {
                    document.querySelector('#info h1').innerHTML = title
                    document.querySelector('#info p').innerHTML = html
                    modal.open('info')
                }
            }
        },
        el: function(name = null) {
            if (name != null) {
                let b = document.querySelector('modal#' + name)
                if (b == null) {
                    throw 'ERROR: modal not found'
                } else {
                    return b
                }
            } else {
                throw 'ERROR: invalid argument'
            }
        },
        open: function(target = null) {
            if (target != null) {
                document.querySelector('modal#' + target).classList.remove('hidden')
                document.querySelector('modal#' + target).style.zIndex = this.basezindex++;
                setTimeout(() => {
                    document.querySelector('modal#' + target).classList.remove('fadeout')
                }, 10)
            }
        },
        isOpen: (target = null) => {
            if (target) {
                return !document.querySelector('modal#' + target).classList.contains('fadeout')
            } else {
                return undefined
            }
        },
        close: function(target = null) {
            if (target != null) {
                document.querySelector('modal#' + target).classList.add('fadeout')
                setTimeout(() => {
                    document.querySelector('modal#' + target).classList.add('hidden')
                }, 270);
            }
        },
        init: function() {
            document.querySelectorAll('.close-button').forEach((item) => {
                item.onclick = (event) => {
                    this.close(item.parentElement.parentElement.id)
                }
            })
            document.querySelectorAll('modal').forEach((item) => {
                item.onclick = (event) => {
                    if (event.target.tagName == 'MODAL') {
                        this.close(item.id)
                    }
                }
            })
            document.querySelectorAll('[data-modal]').forEach((item) => {
                item.onclick = (event) => {
                    this.open(item.getAttribute('data-modal'))
                }
            })
        }
    }
    modal.init();
    setTimeout(() => {
        if (shortcut.count <= 1) {
            modal.open('openfile')
            openFile.el.textBox.select()
        }
        if (settings.usingNW) {
            nwWindow.show(true)
        }
    }, 400);

    notes.onFinishLoad()
</script>
<style>
    .logo, renderer {
        --image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAexQTFRFs7OzTU1NGhoaZmZmMzMzmZmZ5ubmTExMSkpKS0tLzMzMRkZGPz8/RUVFR0dHSEhIQ0NDRERENjY2Ojo6c3NzSUlJVlZWsrKyPDw8Pj4+cXFxNDQ0GRkZQUFBo6OjpqamQEBAbm5uGBgYjY2NOTk5bW1tODg4vLy8f39/Ozs7LCwsFxcXISEhsbGxnp6ecHBwQkJCoqKiFBQUU1NTFhYWZ2dnW1tbsLCwrq6uUlJSr6+vq6urgYGBu7u7rKysmpqaPT09mJiYra2tUFBQt7e3nZ2dYmJiqampb29vFRUVkZGRgICAV1dXpaWlWFhYNTU1VFRUp6enqqqqnJyckJCQdnZ2Ly8veXl5Nzc3k5OTcnJyn5+fd3d3lZWVjo6OhoaGXFxcMDAwdHR0Hh4eY2NjaWlpl5eXYWFhqKioXV1dlpaWeHh4lJSUioqKenp6goKCHx8fIiIie3t7m5ubLS0tpKSkWlpahISEaGhoT09PWVlZampqkpKSh4eHi4uLj4+Pfn5+fX19vb29MjIywMDAjIyMwcHBEBAQERERLi4uYGBgKioqiIiIg4ODIyMjHR0dhYWFiYmJEhISJCQk0NDQXl5eJycnUVFRZWVlJSUlZGRkTk5O29vboKCgoaGha2trdXV1ExMTfHx8AAAAl+Ea6QAAAKR0Uk5T/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wA2IyjeAAAKtklEQVR42uzd91vbSBoAYA8kKymyigFhG2QjFIeNz2ciYpohBw5eILTQAgkQCCmkJ7ub3nezvd3d7vXe8o+eJAtjWDsx1qdia74fefyA50XTZz753ng8fBgAA2AADIABMAAGwAAYAANgAAyAATAABsAAGAADYAAMgAEwAAbAABgAA2AADIABMAAGwAAYwCsAAump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')
    }
</style>
<div class="hidden renderer" style="background-image: var(--image);"></div>


</html>