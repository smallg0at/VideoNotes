<!DOCTYPE html>
<html lang="zh" style="background: black;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VideoNotes</title>
    <link rel="stylesheet" importance="high" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
    <link rel="shortcut icon" sizes="128 x 128" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAQcSURBVHhe7dsxL2xBGMbxcQsqHYVIJDqFUEkUFFqNROEDiFZJqVBSivgEGoVSq6CQqIhColCpiEZFc+8+kzObY+PYdc05M7Pz/yXsHm5xY97zzDszZw0AAAAAAAAAAAAAAACAPjKgb39b7BWyMtDyp3gPj1K6nz4lQKsg9IJfuLi4KN4Zs7i4WLyLiytQEgCGAsgcU4BnVVNA+echlP8vTAFoIwE865YACwsL9rUpl5eX9pUEwJcogMxRAJmjADJHE+gZy0AkhQTwrCoBYkICoI0CyBwFkDl6AM9YBSApJIBn3RIg+8OgpaUls7m5WVwhtCBTwNramjk7O7PFgLCC9QDDw8Nmd3fXHB4emunp6eKnaFqwAhgZGbGvMzMz5ujoiGkhkMabQMW+7nwVwNTUlLm/vzcvLy/Fb43Z2dkx5+fnxVV6WAb+kIpgdna2nQgqjpOTE6aFhgRPgDIlwePjo3l/f7fXSgIlQkqqEiAmUSVAmYpibm7OjI+P22sVi/6gWjWgHlEVgDM5OWkLwU0LahA1LbBs9C/KApChoSE7RehL78fGxuzUsb+/b0ZHR4t/hd+Kqgf4ztPTk+0PHCXCwcFBcRUPVgE1UV+gfXQ3LbCb6EcyCVCm1YIS4e3tzV7f3t7azaS7uzt7HVK3BOCTQR6oeLR34AqI3cT/l2QBOCqEzmlBdxrTQu+SLgBHSdC5m3h8fMxuYg/6ogBEp4sqBDctTExM2GlBxYBqSTaBvdCSUY2ioyWjlo51YxkYCXYTe9O3CVDWech0dXVl9vb2zPPzs732qSoBYpJFApSp2JQGSgWZn583p6enHDK1ZFEAqJZFAWgKuL6+bp8laApYXV1tpCmMXV/3AJrzNejukTNtHW9vb9e6ZcwqIBIaeN31bvD1ZNHy8nIU5wUx6bsEaLLj/0q3BOAwqCYa8JubG/uUsd6/vr7aeX5ra6uxwU9R8gWgwdagK+41x+tLcb+yssLA9yDpAlDc61kAN8/rKWLN8yl/rqBpSRaA7nLd8S7u3bIutUfIY5BUE6jB7lzW6SHRmO54loE10cleeVmn0z3i/veiT4DQy7qfqkqAmCSRAK67d/O86+5Z1vkVZQFU7eIR9/5FVQAacA28e5LHdfcMfH2i6AFc3CvmRbt4GxsbSUY9q4AfcAPPLl44QRNAA17u7tXgpa5bAnAYVNB8r8F/eHhoH9qgecEKwMX9+vo6cR9QkALQo1gs6+LQeAFo0GP8XH+uGm8C+x3LQCSFBPCsKgFiQgKgjQLIHAWQOXoAz1gFICkkgGfdEoDDIESFAsgcBZA5CiBzNIGesQxEUkgAz6oSICYkANoogMxRAJn71APAj4+PDzM4OFhcxUs9AAWQMTf+AAAAAAAAAAAAAAAAAAAAAAAASI4x/wDxTht4UVJ/sAAAAABJRU5ErkJggg==" type="image/x-icon">
    <link rel="shortcut icon" href="./res/VNIcon.ico" type="image/x-icon">
    <!-- <link rel="shortcut icon" sizes="16 x 16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADvSURBVFhH7ZbNDcIwDIULc7AIgzAIa3HlzAbc2IQbp9bPxVGwZMuBIB+aT3pyQl3r9fETpsHm2ZHmdZnHPwxEZ86SAGpPZKZnpFyPum0hOnPevxdpeAaOpF/Twf2WmEgCD9JhXTaD99lSobhRSAKiMymKNVPDfVazNvAk3UiRNGRmfb8W4CobjTZQ60TyQE8E7rOaPQNI40qy0kBPBO6zmj0DtS4kDV6XaglwlY3GM/AipSaQ8hnAU99Jad+CtN+B6FPXdDXwDXIfqiXAVTY9ic7MP45xKsHtx+nUAZnpJVGuR+NqITqz/CccDLbKNC3BYZd+KkW/eAAAAABJRU5ErkJggg==" type="image/x-icon"> -->
    <link rel="manifest" href="./webmanifest.json">
    <style>
        #load-cover{
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: black;
            color: rgba(255, 255, 255,0.8);
            display: flex;
            flex-flow: column nowrap;
            justify-content: center;
            align-content: center;
            z-index: 99999;
            text-align: center;
        }
    </style>
    <link rel="stylesheet" href="./main.css">
</head>

<body>
    <div id="load-cover">
        <h1 style="font-size: 60px;font-weight: normal;margin-bottom: 0;">VideoNotes</h1>
        <p>Loading...</p>
    </div>
    <div class="left">
        <video src="about:blank"></video>
        <iframe src="" allow="fullscreen" frameborder="0" class="hidden" nwfaketop>
            <div class="error">
                <i class="ms-Icon ms-Icon--Error" aria-hidden="true"></i>
                <iconlabel class="important">您的浏览器不支持 iframe。<br>本功能将无法正常工作。<br>是时候换个好一点的浏览器了！</iconlabel>
            </div>
        </iframe>
        <div id="iframe-loading" class="hidden"><i class="ms-Icon ms-Icon--WebAppBuilderModule spinning" style="font-size: 45px;" aria-hidden="true"></i></div>
        <div class="media-playback-percentage">
            <div id="play-length"></div>
            <div class="media-playback-timing"></div>
        </div>
    </div>
    <div class="right">
        <group>
            <textarea name="" id="ta1" cols="30" rows="5" placeholder="正在加载中···\n\n如果您长时间看到此提示，网页可能工作不正常。"></textarea>
            <!-- <textarea name="" id="ta2" cols="30" rows="5" placeholder="texttext"></textarea>
            <textarea name="" id="ta3" cols="30" rows="5" placeholder="texttext"></textarea>
            <textarea name="" id="ta4" cols="30" rows="5" placeholder="texttext"></textarea> -->
        </group>
        <noscript>
            <i class="ms-Icon ms-Icon--StatusErrorFull" aria-hidden="true"></i>
            <iconlabel class="important">JavaScript 未被启用。<br>本网页将无法正常工作。<br>如果您已启用 JavaScript 页面却未工作，请下载网页后用浏览器打开。</iconlabel>
        </noscript>
        <div class="error fix hidden" id="ie-warning">
            <i class="ms-Icon ms-Icon--DRM" aria-hidden="true"></i>
            <iconlabel class="important">本网页不支持 Internet Explorer，无法正常工作。<br>建议更换 Chromium 内核的浏览器。</iconlabel>
        </div>

        <div>
            <div style="display: flex;position: relative;" id="time-edt" class="nodisplay timecontrols">
                <interaction class="half" onclick="videoPlayer.seek(-5)"><i class="ms-Icon ms-Icon--DoubleChevronLeft8" aria-hidden="true"></i></interaction>
                <interaction class="half" onclick="videoPlayer.jump()"><i class="ms-Icon ms-Icon--SIPMove" aria-hidden="true"></i></interaction>
                <interaction class="half" onclick="videoPlayer.seek(5)"><i class="ms-Icon ms-Icon--DoubleChevronRight8" aria-hidden="true"></i></interaction>
            </div>
            <div style="display: flex;flex-shrink: 0;" class="filecontrols">
                <interaction onclick="togglePlayPause()" left id="playpause" style="flex-shrink: 1.4; margin-right: 6px;">
                    <i class="ms-Icon ms-Icon--OpenFile" aria-hidden="true"></i>
                    <iconlabel class="important">打开 (o)</iconlabel>
                </interaction>
                <!-- <interaction onclick="toggleInfo()" id="info" style="width: 50px"><i class="ms-Icon ms-Icon--Info" aria-hidden="true"></i>
                </interaction> -->
                <interaction id="settings-btn" data-modal="settings" style="width: 50px" title="设置 (s)"><i class="ms-Icon ms-Icon--Settings" id="settings-icon" aria-hidden="true"></i>
                </interaction>
                <interaction onclick="gui.fullscreen.toggle()" id="fullscreen" style="width: 50px" title="全屏 (f)"><i class="ms-Icon ms-Icon--FullScreen" aria-hidden="true"></i>
                </interaction>
            </div>
        </div>
    </div>
    <modal id="openfile" class="hidden fadeout">
        <div class="modal-card">
            <div class="close-button">×</div>
            <div class="modal-content">
                <h2>打开文件</h2>
                <div id="open-network-url">
                    <input type="text" placeholder="输入视频网站链接 / 视频 URL / 以'||'为开头的页面地址" id="URLtextbox"></input>
                    <button id="URLpaste" title="粘贴"><i class="ms-Icon ms-Icon--Paste" aria-hidden="true" single></i></button>
                    <button id="URLopen" title="打开" onclick="onSubmitVideoURL()"><i class="ms-Icon ms-Icon--Forward" aria-hidden="true" single></i></button>
                    <label for="openlf" class="input-file-alternative no-custom"><i class="ms-Icon ms-Icon--OpenFolderHorizontal" aria-hidden="true"></i><span style="vertical-align: center;">本地选取文件</span></label>
                    <!-- <input type="button" value='<i class= ms-Icon ms-Icon--OpenFile' aria-hidden='true'\>\<\/i\>打开" id="URLopen"></input> -->
                </div>
                <input type="file" name="openlf" id="openlf" accept="video/mp4, .html, .pdf, .swf">
                <!-- <p id="grant-clipboard">建议您先允许剪贴板权限。<help onclick="settingUtils.interaction.grantClipboard()">点击以允许</help>
                </p> -->
                <p id="file-info" class="hidden"></p>
                <p>您可以从本地选取文件，或粘贴视频网站链接/视频源文件链接。<help data-modal="settings">查看帮助</help>
                </p>
            </div>
        </div>
    </modal>
    <modal id="info" class="hidden fadeout">
        <div class="modal-card" style="height: fit-content;">
            <div class="close-button">×</div>
            <div class="modal-content">
                <h1>信息</h1>
                <p style="line-height: 1.5em;font-size: larger;">...</p>
            </div>
        </div>
    </modal>
    <modal id="settings" class="hidden fadeout">
        <div class="modal-card">
            <div class="close-button">×</div>
            <div class="modal-content">
                <div class="error hidden" id="localStorage-error">
                    <i class="ms-Icon ms-Icon--InfoSolid" aria-hidden="true"></i>
                    <iconlabel class="important">当前浏览器不支持 localStorage，您记下的笔记不会被缓存，设置不会被保存，在离开页面时我们也会提醒您。<br>建议更换 Chromium 内核的浏览器。</iconlabel>
                </div>
                <div style="display: flex;align-items: center;padding: 10px 14px; background-color: rgb(51, 51, 51);border-radius: 5px;" id="what-card">
                    <div class="logo">
                        <!-- <img src="./VideoNotes.svg" alt="" style="width: 100%;height: 100%;"> -->
                    </div>
                    <div>
                        <h3 style="margin: 0.1em 0 0.5em;">VideoNotes 1.7.2</h3>
                        <p style="margin: 0 0 0.5em;">@smallg0at 编写, 2020/3/31</p>
                        <!-- <p style="margin: 0 0 0.5em;">服务器由 @steven12138z 提供</p> -->
                    </div>
                </div>
                <h3>设置</h3>
                <setting>
                    <select name="bilibili-ext" id="bilibili-ext" style="display: inline-block;">
                        <option value="0">B站小播放器（不支持720P以上）</option>
                        <option value="1">贝贝解析（默认）（无法更换画质）</option>
                    </select>
                    <label for='bilibili-ext'>B站解析接口</label>
                </setting>
                <setting>
                    <input type="checkbox" name="enable-force-method" id="enable-force-method" style="width: 20px;height: 20px">
                    <label for="enable-force-method">启用暴力的本地文件读取方式（不建议开启）</label>
                </setting>
                <interaction style="color: rgba(255, 255, 0, 0.5); width: fit-content;" small onclick="settingUtils.reset()">
                    <i class="ms-Icon ms-Icon--Delete" aria-hidden="true"></i>
                    <iconlabel class="important">重置设置与所有笔记</iconlabel>
                </interaction>
                <h3>打开文件帮助</h3>
                <p>打开暴力方法后，请<strong>务必不要打开100MB以上的本地文件</strong>，否则页面可能崩溃</p>
                <p>
                    以下类型可用：
                </p>
                <ul>
                    <li>bilibili 视频：复制视频链接 或 输入av或bv号即可自动解析，支持分P不支持切换，不支持看番。</li>
                    <li>acfun 视频：复制视频链接 或 输入ac号（如ac0000000）即可自动解析，由于内嵌播放器缘故不支持分P（默认1P），不支持看番。手机横屏观看时不建议全屏。</li>
                    <li>网页：先输入 <code>||</code> 后面直接跟网页链接（二者间不可带空格）。有些网站可能拒绝接受iframe。</li>
                    <li>mp4 视频：输入视频URL即可。打开视频后如需再次打开，请刷新页面。</li>
                </ul>
                <p>
                    以下类型不可用：
                </p>
                <ul>
                    <li>flv：未来会做</li>
                </ul>
                <h3>笔记区帮助</h3>
                <p>在大尺寸设备上，笔记在不操作时会变暗。此时，可选中笔记区后 上下滚动/进行选择/任意击键，或在页面内其他位置戳<code>Ctrl</code>。</p>
                <h3>声明</h3>
                <p>本程序“按原样”提供，不会收集您的个人信息；但通过框架访问的网页无法控制，这类问题与我们无关。</p>
            </div>
        </div>
    </modal>
</body>

<script id="compat">
    try{
        let es6Test = ()=>{
            return 1
        }
    }catch(e){
        var altScript = document.createElement('script')
        altScript.src = './settings.mjs'
        altScript.type = 'text/javascript'
        document.insertBefore(altScript, document.querySelector('#compat'))
        console.log('ES6 Compat!')
    }
</script>
<script src="./main.mjs" type="module"></script>

<style>
    .logo,
    .renderer {
        --image: url('data:image/png;base64,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')
    }
</style>

</html>